---
title: "CSE 160 Final Project"
author:
  - Hamza Ali
  - Wajid Ashraf
  - Jeremy Learner
  - Buckley Ross
  - Tyler Waldvogel
date: "11/29/2021"
output: html_document
---


## R Markdown

```{r}
data_raw <- read.csv("movies_metadata.csv")
data_raw <- data_raw[data_raw$status=="Released",]
data <- data_raw[data_raw$vote_count>800,-c(1, 6, 7, 9, 10, 12, 18, 19, 20, 22)]
data <- data[data$revenue>0,]
data <- data[data$budget>1000,]
data$popularity <- as.double(data$popularity)
data$budget <- as.double(data$budget)
data$belongs_to_collection <- !(data$belongs_to_collection=="")
data$homepage <- !(data$homepage == "")
data$genres <- gsub("[[:space:]]", "", data$genres)

data$Action <- grepl('Action', data$genres, fixed = TRUE); data$Adventure <- grepl('Adventure', data$genres, fixed = TRUE); data$Animation <- grepl('Animation', data$genres, fixed = TRUE); data$Comedy <- grepl('Comedy', data$genres, fixed = TRUE); data$Crime <- grepl('Crime', data$genres, fixed = TRUE); data$Drama <- grepl('Drama', data$genres, fixed = TRUE); data$Family <- grepl('Family', data$genres, fixed = TRUE); data$Fantasy <- grepl('Fantasy', data$genres, fixed = TRUE); data$History <- grepl('History', data$genres, fixed = TRUE); data$Horror <- grepl('Horror', data$genres, fixed = TRUE); data$Music <- grepl('Music', data$genres, fixed = TRUE); data$Mystery <- grepl('Mystery', data$genres, fixed = TRUE); data$Romance <- grepl('Romance', data$genres, fixed = TRUE); data$Science_Fiction <- grepl('ScienceFiction', data$genres, fixed = TRUE); data$Thriller <- grepl('Thriller', data$genres, fixed = TRUE); data$War <- grepl('War', data$genres, fixed = TRUE); data$Western <- grepl('Western', data$genres, fixed = TRUE);
data <- data[,-c(3,7,8)]

data$release_date <- as.Date(data$release_date)
data$year = as.numeric(format(data$release_date, format = "%Y"));
data$month = as.numeric(format(data$release_date, format = "%m"));
data$day = as.numeric(format(data$release_date, format = "%d"));

data$ratio <- (data$revenue/data$budget)
data$is_successful <- (data$ratio > 4)
```

```{r}
library(caTools)
library(ROCR)
library(e1071)

data$Class <- replace(data$Class, 2, 0)
data$Class <- replace(data$Class, 4, 1)

split <- sample(2, nrow(data), replace = TRUE, prob = c(.8, .2))
trainData <- data[split == 1,]
testData <- data[split == 2,]
#NB
nb <- naiveBayes(formula = as.factor(Class) ~., data = trainData)
pNB <- predict(nb, newdata = testData, type = 'raw')
curveNB <- prediction(pNB[,2], testData$Class)
performanceNB <- performance(curveNB, 'tpr', 'fpr')
regressionModel <- glm(Class ~ ., data = trainData, family = "binomial")
pred <- predict(regressionModel, testData, type = "response")
t <-table(data.frame(testData$Class, pred > .5))
curveLR <- prediction(pred, testData$Class)
performanceLR <- performance(curveLR, 'tpr', 'fpr')
plot(performanceNB, col = 1, main = "ROC")
plot(performanceLR, col = 2, add = T)
legend(.6,.3,c('Naive Bayes', 'Logistic Regression'), 1:2)

```


## Including Plots

You can also embed plots, for example:


```{r}

revenuemodel <- lm(revenue~budget+popularity+vote_count,data = data)

summary(revenuemodel) #chose those variables because they had the highest r squared
plot(revenuemodel)

revenuemodel2 <- lm(revenue~budget+vote_count,data = data)
summary(revenuemodel2) 
plot(revenuemodel2)

revenuemodel3 <- glm(revenue~budget+popularity+vote_count,data = data)
summary(revenuemodel3)



```

```{r}



```

